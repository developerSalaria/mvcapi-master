@{
    ViewBag.Title = "Users";
}
<style>
    #roleTable_filter {
        float: right !important;
    }
    #roleTable_filter input {
        width: 201px !important;
    }
</style>
<div class="kt-portlet kt-portlet--mobile pea-page" style="box-shadow: 5px 5px 15px 5px rgba(0,0,0,0.35);" id="customerPolicies">
    <div class="kt-portlet__head" style="background: #F35869 !important;min-height:32px;border-radius:4px;">
        <div class="kt-portlet__head-label">
            <span class="kt-portlet__head-icon">
                <i class="fas fa-user text-white"></i>
            </span>
            <h3 class="kt-portlet__head-title text-white" style="font-size:17px !important;">
                Roles
            </h3>
        </div>
    </div>
    <div class="kt-portlet__body">
        <div class="row">
            <div class="col-md-12">
                <a class="btn text-white mb-2" id="btnAddNewRole" style="background-color:#F35869 ;float:right !important;"><i class="fas fa-plus"></i>Add Role</a>
            </div>
        </div>
        <div id="kt_table_1_wrapper" class="dataTables_wrapper dt-bootstrap4">
            <div class="row">
                <div class="col-sm-12" id="policiesListDiv">
                    <table class="table table-striped table-bordered table-hover table-checkable" id="roleTable">
                        <thead>
                            <tr style="background-color: #22b9ff;">
                                <th style="color:#fff" data-field="Name">Name </th>
                                <th style="        color: #fff;
                                width: 220px !important" data-field="Actions">Actions</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>



<!--region Editpolicy Model pop up -->
<div id="editRoleModal" class="modal animated slideInRight in slideInLeft out" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-xl" style="max-width: 85%">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title font-weight-bold">
                    User
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body" id="editRoleModalBody">

            </div>
        </div>
    </div>
</div>
<!--endregion Edit policy Model pop up -->




@section scripts
    {
    @Scripts.Render("~/Scripts/Datatable/Datatable/datatables.min.js")
    <script>
            //use for add new Role
            $("#btnAddNewRole").on("click", function () {
                $.ajax({
                    url: '@Url.Action("AddEditRole", "RoleManager")',
                    success: function (data) {
                        $("#editRoleModalBody").html(data);
                        $("#editRoleModal").modal("show");
                    }
                })
            });

           //Roles list table
            $('#roleTable').DataTable({
                    "processing": true, // for show progress bar
                    //"serverSide": true, // for process server side
                    "filter": true, // this is for disable filter (search box)
                    "orderMulti": false, // for disable multiple column at once
                    "language": {
                        "loadingRecords": "&nbsp;",
                        "sProcessing": "<i class='fas fa-spinner fa-2x text-success fa-spin'></i>",
                        "emptyTable": "No data available in table",
                        "info": "Showing _START_ to _END_ of _TOTAL_ entries",
                        "infoEmpty": "Showing 0 to 0 of 0 entries",
                        "infoFiltered": "(filtered from _MAX_ total entries)",
                        "infoPostFix": "",
                        "thousands": ",",
                        "lengthMenu": "Show _MENU_ entries",
                        "loadingRecords": "Loading...",
                        "processing": "Processing...",
                        "search": "Search:",
                        "zeroRecords": "No matching records found",
                        "paginate": {
                            "first": "First",
                            "last": "Last",
                            "next": "Next",
                            "previous": "Previous"
                        },
                        "aria": {
                            "sortAscending": ": activate to sort column ascending",
                            "sortDescending": ": activate to sort column descending"
                        }
                    },
                    "bDestroy": true,
                    "ajax": {
                        "url": "@Url.Action("GetRoles", "RoleManager")",
                    },
                    "columns": [

                        { "data": "Name", "name": "Name", "autoWidth": true },
                        {
                        "data": "Actions", "orderable": false, "autoWidth": true, "render": function (data, type, row) {
                            return `
                                    <button type = "button" id="editRole" onClick=editRole("${row.Id}") class="btn btn-sm btn-secondary btn-icon"><i class="flaticon-edit"></i></button>
                                    <button type="button" onClick=deleteRole("${row.Id}") class="btn btn-sm btn-danger btn-icon"><i class="flaticon-delete"></i></button>`;
                        }
                    }
                    ],
                    "initComplete": function () {
                        $('[data-toggle="tooltip"]').tooltip();

                    }
            })

         //delete Role by Id
        function deleteRole(roleId) {
            debugger
          $.ajax({
              url: '@Url.Action("DeleteRoleById", "RoleManager")',
              type: "POST",
              data: {roleId:  roleId},
                 success: function (data) {
                        swal.fire({
                            title: "Deleted Successfully!",
                            type: "success"
                        }).then(function () {
                            window.location.href = '/RoleManager/List'
                        });
                    }
                })
        }

        //edit Role by Id
        function editRole(roleId) {
            debugger
          $.ajax({
              url: '@Url.Action("AddEditRole", "RoleManager")',
              type: "GET",
              data: {roleId:  roleId},
                 success: function (data) {
                        $("#editRoleModalBody").html(data);
                        $("#editRoleModal").modal("show");
                    }
                })
        }
    </script>

}




