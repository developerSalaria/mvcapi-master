@using TPA.Common.Core.Model;
@using TPA.Presentation.ApiServices;
@model ViewClaimModel

@{
    Layout = null;
    //deeclare for calculate total amount
    decimal totalServiceAmount = 0;
    decimal totalCoshareAmount = 0;
    decimal totalInsured = 0;
    string providerName = "";
    Provider provider = ProviderService.Instance.GetById(Model.Claim.ProviderID);
    if (provider != null)
    {
        providerName = provider.Name;
    }

    string doctorSpecialityName = "";
    DoctorSpeciality doctorSpeciality = DoctorSpecialityService.Instance.GetById(Model.Claim.DoctorSpecialityID);
    if (doctorSpeciality != null)
    {
        doctorSpecialityName = doctorSpeciality.EName;
    }

    string visitTypeName = "";
    VisitType visitType = VisitTypeService.Instance.GetById(Model.Claim.VisitTypeID);
    if (visitType != null)
    {
        visitTypeName = visitType.EName;
    }

    string statusName = "";
    Status status = StatusService.Instance.GetById(Model.Claim.StatusID);
    if (status != null)
    {
        statusName = status.Name;
    }
}
@if (Model == null)
{
    <h4>No Claim Found...</h4>
}
else
{
    @Html.HiddenFor(m => m.Claim.ID, new { id = "viewClaimId" });
    <div class="kt-portlet kt-portlet--mobile pea-page">
        <div class="kt-portlet mt-3">
            <div class="kt-portlet__body">
                <div class="row">
                    <div class="col-md-9 col-lg-12">
                        <div class="row kt-margin-b-20">
                            <div class="col-md-3">
                                <p class="font-weight-normal">Claim No</p>
                            </div>
                            <div class="col-md-3">
                                @Model.Claim.ClaimNo
                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Provider</p>
                            </div>
                            <div class="col-md-3">
                                @providerName
                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Status</p>
                            </div>

                            <div class="col-md-3">
                                @statusName
                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Insurance Id</p>
                            </div>
                            <div class="col-md-3">
                                @Model.Claim.PolicyCode
                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Visit Type</p>
                            </div>
                            <div class="col-md-3">
                                @visitTypeName
                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Visit Date</p>
                            </div>
                            <div class="col-md-3">
                                @Model.Claim.VisitDate.ToString("dd-MM-yyyy")
                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Visit Name</p>
                            </div>
                            <div class="col-md-3">

                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Doctor Speciality</p>
                            </div>
                            <div class="col-md-3">
                                @doctorSpecialityName
                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Insured Name</p>
                            </div>
                            <div class="col-md-3">

                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Contract Owner</p>
                            </div>
                            <div class="col-md-3">

                            </div>
                            <div class="col-md-3">
                                <p class="font-weight-normal">Insurance Company</p>
                            </div>
                            <div class="col-md-3">
                                @Model.Claim.CompanyName
                            </div>
                            <div class="col-lg-3">
                                <p class="font-weight-normal"> Provider</p>
                            </div>
                            <div class="col-lg-3">
                                @Model.Claim.ProviderNotes
                            </div>
                            <div class="col-lg-3">
                                <p class="font-weight-normal"> Auditor</p>
                            </div>

                            <div class="col-lg-3">
                                @Model.Claim.AuditorNotes
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row kt-margin-t-20">
                    <div class="col-lg-12">
                        <h4>Symptoms</h4>
                        <hr />
                    </div>
                    <div class="col-lg-12">
                        <table class="view-claim-tbl">
                            <thead>
                                <tr>
                                  <th>Symptom Description</th>
                                </tr>
                            </thead>
                            <thead>
                                @foreach (var symptom in Model.Symptoms)
                                {
                                    <tr>
                                        <td>@symptom.EName</td>
                                    </tr>
                                }

                            </thead>
                        </table>
                    </div>
                </div>
                <div class="row kt-margin-t-20">
                    <div class="col-lg-12">
                        <h4>Services</h4>
                        <hr />
                    </div>
                    <div class="col-lg-12">
                        <table class="view-claim-tbl">
                            <thead>
                                <tr>
                                    @*<th>Code</th>*@
                                    <th>Service Name</th>
                                    @*<th>Service Type</th>*@
                                    <th>Service Price</th>
                                    <th>Rule</th>
                                    @*<th>Coshare Type</th>*@
                                    @*<th>Coshare</th>*@
                                    <th>Coshare Amount</th>
                                    <th>Insured</th>
                                    @*<th>Overdue</th>*@
                                    @*<th>Status</th>*@
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var service in Model.Services)
                                {
                                   //calculate total 
                                    totalServiceAmount = service.ServiceAmount + totalServiceAmount;
                                    totalCoshareAmount = service.CoShareAmount + totalCoshareAmount;
                                    totalInsured = service.InsuredAmount + totalInsured;
                                    <tr>
                                        @*<td>@service.EName</td>*@
                                        <td>@service.EName</td>
                                        @*<td>Service Type</td>*@
                                        <td>@service.ServiceAmount</td>
                                        <td>@service.EName</td>
                                        @*<td>Coshare Type</td>*@
                                        @*<td>@service.CoSharePercentage</td>*@
                                        <td>@service.CoShareAmount</td>
                                        <td>@service.InsuredAmount</td>
                                        @*<td>Overdue</td>*@
                                        @*<td>@service.StatusID</td>*@
                                    </tr>
                                }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td style="font-weight:700">Total</td>
                                    <td style="font-weight:700">@totalServiceAmount</td>
                                    <td style="font-weight:700"></td>
                                    <td style="font-weight:700">@totalCoshareAmount</td>
                                    <td style="font-weight:700">@totalInsured</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
}